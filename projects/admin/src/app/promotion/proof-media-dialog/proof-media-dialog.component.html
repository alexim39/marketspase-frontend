<div class="proof-media-dialog">
  <div class="dialog-header">
    <h2 mat-dialog-title>Proof Media Review</h2>
    <button mat-icon-button class="close-btn" (click)="onClose()">
      <mat-icon>close</mat-icon>
    </button>
  </div>
  
  <mat-dialog-content>
    <!-- Main Content Container -->
    <div class="content-container">
      <!-- Left Panel: Image Viewer -->
      <div class="image-viewer-panel">
        <div class="image-viewer-header">
          <h3>Proof Media ({{ promotion.proofMedia.length }})</h3>
          <div class="viewer-controls">
            <button mat-icon-button (click)="previousImage()" [disabled]="selectedImageIndex() === 0">
              <mat-icon>chevron_left</mat-icon>
            </button>
            <span class="image-counter">{{ selectedImageIndex() + 1 }} / {{ promotion.proofMedia.length }}</span>
            <button mat-icon-button (click)="nextImage()" [disabled]="selectedImageIndex() === promotion.proofMedia.length - 1">
              <mat-icon>chevron_right</mat-icon>
            </button>
            <button mat-icon-button (click)="downloadImage()" class="download-btn">
              <mat-icon>download</mat-icon>
            </button>
          </div>
        </div>
        
        <!-- Main Image Viewer -->
        <div class="main-image-viewer" 
             #imageViewer
             [class.dragging]="viewState().isDragging">
          <div class="image-container">
            @if (promotion.proofMedia.length > 0) {
              <div class="main-image-wrapper" 
                   #imageWrapper
                   [style.transform]="getTransform()">
                <img 
                  [src]="promotion.proofMedia[selectedImageIndex()]" 
                  [alt]="'Proof image ' + (selectedImageIndex() + 1)"
                  class="main-image"
                  loading="eager">
              </div>
              
              <!-- Zoom Controls -->
              @if (viewState().scale > 1) {
                <div class="reset-view-btn" (click)="resetView()">
                  <mat-icon>crop_free</mat-icon>
                  Reset View
                </div>
              }
              
              <div class="zoom-info">
                {{ getZoomPercentage() }}%
              </div>
              
              <div class="zoom-controls">
                <button mat-icon-button 
                        (click)="zoomIn()" 
                        [disabled]="isAtMaxZoom()"
                        matTooltip="Zoom In (Ctrl +)">
                  <mat-icon>zoom_in</mat-icon>
                </button>
                <button mat-icon-button 
                        (click)="zoomOut()" 
                        [disabled]="isAtMinZoom()"
                        matTooltip="Zoom Out (Ctrl -)">
                  <mat-icon>zoom_out</mat-icon>
                </button>
              </div>
              
              <!-- Zoom Hint -->
              <!-- @if (viewState().scale === 1) {
                <div class="zoom-hint">
                  <mat-icon>zoom_in</mat-icon>
                  <span>Ctrl + Scroll to zoom | Click & drag to pan when zoomed</span>
                </div>
              } -->
            } @else {
              <div class="no-images">
                <mat-icon>image_not_supported</mat-icon>
                <p>No proof images available</p>
              </div>
            }
          </div>
        </div>
        
        <!-- Thumbnail Strip -->
        @if (promotion.proofMedia.length > 1) {
          <div class="thumbnail-strip">
            @for (media of promotion.proofMedia; track media; let i = $index) {
              <div 
                class="thumbnail-container"
                [class.selected]="i === selectedImageIndex()"
                (click)="selectImage(i)">
                <img 
                  [src]="media" 
                  [alt]="'Thumbnail ' + (i + 1)"
                  class="thumbnail">
                <div class="thumbnail-overlay">
                  <span>View</span>
                </div>
              </div>
            }
          </div>
        }
      </div>
      
      <!-- Right Panel: Promotion Details -->
      <div class="details-panel">
        <div class="details-header">
          <h3>Promotion Details</h3>
          <mat-chip class="status-chip submitted">Submitted</mat-chip>
        </div>
        
        <mat-divider></mat-divider>
        
        <div class="details-content">
          <div class="detail-row">
            <mat-icon class="detail-icon">qr_code_2</mat-icon>
            <div class="detail-info">
              <span class="detail-label">UPI Code</span>
              <span class="detail-value upi-code">{{ promotion.upi }}</span>
            </div>
          </div>
          
          <div class="detail-row">
            <mat-icon class="detail-icon">campaign</mat-icon>
            <div class="detail-info">
              <span class="detail-label">Campaign</span>
              <span class="detail-value">{{ getCampaignTitle() }}</span>
            </div>
          </div>
          
          <div class="detail-row">
            <mat-icon class="detail-icon">person</mat-icon>
            <div class="detail-info">
              <span class="detail-label">Promoter</span>
              <span class="detail-value">{{ getPromoterName() }}</span>
              <span class="detail-subtext">{{ getPromoterEmail() }}</span>
            </div>
          </div>
          
          <div class="detail-row">
            <mat-icon class="detail-icon">visibility</mat-icon>
            <div class="detail-info">
              <span class="detail-label">Proof Views</span>
              <span class="detail-value">{{ promotion.proofViews || 'Not specified' }}</span>
            </div>
          </div>

          <div class="detail-row">
            <mat-icon class="detail-icon">calendar_today</mat-icon>
            <div class="detail-info">
              <span class="detail-label">Created</span>
              <span class="detail-value">{{ promotion.createdAt | date:'medium' }}</span>
            </div>
          </div>
          
          <div class="detail-row">
            <mat-icon class="detail-icon">schedule</mat-icon>
            <div class="detail-info">
              <span class="detail-label">Submitted On</span>
              <span class="detail-value">{{ promotion.submittedAt | date:'medium' }}</span>
              <span class="detail-subtext">{{ timeSinceSubmission() }}</span>
            </div>
          </div>
          
          <div class="detail-row">
            <mat-icon class="detail-icon">timelapse</mat-icon>
            <div class="detail-info">
              <span class="detail-label">Time to Submit</span>
              <span class="detail-value">{{ getTimeDifference() }}</span>
              <span class="detail-subtext">From creation to submission</span>
            </div>
          </div> 
          
          @if (promotion.activityLog.length > 0) {
            <div class="detail-row">
              <mat-icon class="detail-icon">history</mat-icon>
              <div class="detail-info">
                <span class="detail-label">Activity Log</span>
                <span class="detail-value">{{ promotion.activityLog.length }} entries</span>
              </div>
            </div>
            }
        </div>
        
        <mat-divider></mat-divider>
        
        <!-- Action Buttons -->
        <div class="action-buttons">
          <button mat-flat-button 
                  color="primary" 
                  class="validate-btn"
                  (click)="validatePromotion()"
                  [disabled]="isLoading()">
            <mat-icon>check_circle</mat-icon>
            @if (isLoading()) {
              Validating...
            } @else {
              Approve
            }
          </button>
          
          <button mat-stroked-button 
                  color="warn" 
                  class="reject-btn"
                  (click)="rejectPromotion()"
                  [disabled]="isLoading()">
            <mat-icon>cancel</mat-icon>
            Reject
          </button>
        </div>
      </div>
    </div>
  </mat-dialog-content>
</div>