@if (loadingService.isLoading$ | async) {
    <mat-progress-bar mode="indeterminate"/>
}

<div class="admin-dashboard">
    <!-- Sidebar -->
    <aside class="sidebar" [class.collapsed]="sidebarCollapsed()">
    <div class="sidebar-header">
        <div class="logo">
            <div class="logo-icon">
                <mat-icon>sync</mat-icon>
            </div>
            <span class="logo-text">MarketSpase Admin</span>
        </div>
        <button class="sidebar-toggle" (click)="toggleSidebar()">
            <mat-icon>{{ sidebarCollapsed() ? 'chevron_right' : 'chevron_left' }}</mat-icon>
        </button>
    </div>
    
    <nav class="nav-menu">
        <a 
            class="nav-item"
            [class.active]="activeNavItem() === 'dashboard'"
            (click)="setActiveNavItem('dashboard')"
            routerLink="/dashboard" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}"
            >
            <mat-icon>dashboard</mat-icon>
            <span>Dashboard</span>
        </a>

        <a 
            class="nav-item" 
            [class.active]="activeNavItem() === 'user'"
            (click)="setActiveNavItem('user')"
            routerLink="/dashboard/users" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}"
            >
            <mat-icon>account_circle</mat-icon>
            <span>Users</span>
        </a>

        <a 
            class="nav-item" 
            [class.active]="activeNavItem() === 'campaigns'"
            (click)="setActiveNavItem('campaigns')"
            routerLink="/dashboard/campaigns" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}"
            >
            <mat-icon>campaign</mat-icon>
            <span>Campaigns</span>
        </a>

        <a 
            class="nav-item" 
            [class.active]="activeNavItem() === 'promotions'"
            (click)="setActiveNavItem('promotions')"
            routerLink="/dashboard/promotions" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}"
            >
            <mat-icon>sell</mat-icon>
            <span>Promotions</span>
        </a>

        <a 
        class="nav-item" 
        [class.active]="activeNavItem() === 'testimonials'"
        (click)="setActiveNavItem('testimonials')"
        routerLink="/dashboard/testimonials" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}"
        >
        <mat-icon>reviews</mat-icon>
        <span>Testimonials</span>
        </a>

        <a 
        class="nav-item" 
        [class.active]="activeNavItem() === 'newsletters'"
        (click)="setActiveNavItem('newsletters')"
        routerLink="/dashboard/newsletters" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}"
        >
        <mat-icon>newspaper</mat-icon>
        <span>Newsletters</span>
        </a>

        <a 
        class="nav-item" 
        [class.active]="activeNavItem() === 'financial'"
        (click)="setActiveNavItem('financial')"
        routerLink="/dashboard/financial" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}"
        >
        <mat-icon>payment_arrow_down</mat-icon>
        <span>Financials</span>
        </a>

       <!--  <a 
        class="nav-item" 
        [class.active]="activeNavItem() === 'proof'"
        (click)="setActiveNavItem('proof')"
        routerLink="/dashboard/financial" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}"
        >
        <mat-icon>approval</mat-icon>
        <span>Proofs</span>
        </a> -->

       <!--  <a 
        class="nav-item" 
        [class.active]="activeNavItem() === 'transactions'"
        (click)="setActiveNavItem('transactions')"
        routerLink="/dashboard/financial" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}"
        >
        <mat-icon>checkbook</mat-icon>
        <span>Transactions</span>
        </a> -->

        <a 
        class="nav-item" 
        [class.active]="activeNavItem() === 'analytics'"
        (click)="setActiveNavItem('analytics')"
        routerLink="/dashboard/analytics" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
        <mat-icon>analytics</mat-icon>
        <span>Analytics</span>
        </a>

        <a 
        class="nav-item" 
        [class.active]="activeNavItem() === 'settings'"
        (click)="setActiveNavItem('settings')"
        routerLink="/dashboard/settings" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}"
        >
        <mat-icon>settings</mat-icon>
        <span>Settings</span>
        </a>

        <div 
        class="nav-item" 
        [class.active]="activeNavItem() === 'logout'"
        (click)="logout()">
        <mat-icon>logout</mat-icon>
        <span>Sign out</span>
        </div>

    </nav>
    
    <div class="admin-profile">
        <div class="admin-avatar">
        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjAiIGN5PSIyMCIgcj0iMjAiIGZpbGw9IiM2NjdFRUEiLz4KPHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4PSI4IiB5PSI4Ij4KPHBhdGggZD0iTTIwIDIxVjE5QTQgNCAwIDAgMCAxNiAxNUg4QTQgNCAwIDAgMCA0IDE5VjIxIiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgo8Y2lyY2xlIGN4PSIxMiIgY3k9IjciIHI9IjQiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+Cjwvc3ZnPgo8L3N2Zz4K" alt="Admin">
        </div>
        <div class="admin-info">
        <div class="admin-name">{{ adminService.adminData()?.name || 'Admin' }}</div>
        <div class="admin-role">{{ adminService.adminData()?.role || 'User' }}</div>
        </div>
    </div>
    </aside>
    
    <!-- Main Content -->
    <div class="main-content">
    <!-- Header -->
    <header class="header">
        <div class="header-left">
        <h1 class="page-title">{{ pageTitle() }}</h1>
        <div class="breadcrumb">{{ currentDate }}</div>
        </div>
        
        <div class="header-right">
        <div class="search-container">
            <mat-icon class="search-icon">search</mat-icon>
            <input 
            type="text" 
            placeholder="Search..."
            class="search-input"
            [value]="searchQuery()"
            (input)="onSearchInput($event)">
        </div>
        
        <div class="header-actions">
            <button class="notification-btn" [class.has-notifications]="notificationCount() > 0">
            <mat-icon>notifications</mat-icon>
            @if (notificationCount() > 0) {
                <span class="notification-badge">{{ notificationCount() }}</span>
            }
            </button>
            
            <!-- <button class="message-btn" [class.has-messages]="messageCount() > 0">
               <mat-icon>email</mat-icon>
                @if (messageCount() > 0) {
                    <span class="notification-badge">{{ messageCount() }}</span>
                }
            </button> -->
        </div>
        </div>
    </header>
    
    <!-- Dynamic Content Area -->
    <router-outlet></router-outlet>
    </div>
</div>