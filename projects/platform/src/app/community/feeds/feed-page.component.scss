@import '../../../styles/variables';
@import '../../../styles/mixins';

.feed-page {
  min-height: 100vh;
  background: var(--background-color);
  
  .feed-header {
    position: sticky;
    top: 0;
    z-index: $z-index-sticky;
    background: var(--surface-color);
    border-bottom: $border-width solid var(--border-color);
    padding: $spacing-4;
    
    @include tablet {
      padding: $spacing-6;
    }
    
    .header-content {
      @include flex-between;
      margin-bottom: $spacing-4;
      
      .header-left {
        display: flex;
        align-items: center;
        gap: $spacing-3;
        
        .page-title {
          @include heading-small;
          margin: 0;
          color: var(--text-primary);
          
          @include tablet {
            font-size: $font-size-3xl;
          }
        }
        
        .live-badge {
          display: flex;
          align-items: center;
          gap: $spacing-1;
          padding: $spacing-1 $spacing-2;
          background: rgba($error-color, 0.1);
          color: $error-color;
          border-radius: $border-radius-xl;
          font-size: $font-size-xs;
          font-weight: $font-weight-semibold;
          
          .live-dot {
            width: 6px;
            height: 6px;
            background: $error-color;
            border-radius: $border-radius-full;
            @include pulse;
          }
        }
      }
      
      .header-actions {
        display: flex;
        gap: $spacing-2;
        
        .refresh-btn {
          color: var(--text-secondary);
          
          &:hover {
            color: $primary-color;
          }
        }
        
        .create-post-btn {
          @include button-primary;
          
          @include mobile {
            span {
              display: none;
            }
            
            mat-icon {
              margin: 0;
            }
          }
        }
      }
    }
    
    .search-bar {
      position: relative;
      margin-bottom: $spacing-4;
      
      .search-icon {
        position: absolute;
        left: $spacing-3;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text-tertiary);
        font-size: $font-size-lg;
      }
      
      .search-input {
        width: 100%;
        padding: $spacing-3 $spacing-3 $spacing-3 $spacing-8;
        background: var(--background-color);
        border: $border-width solid var(--border-color);
        border-radius: $border-radius-xl;
        font-size: $font-size-sm;
        color: var(--text-primary);
        transition: all $transition-normal;
        
        &:focus {
          outline: none;
          border-color: $primary-color;
          box-shadow: 0 0 0 3px rgba($primary-rgb, 0.1);
        }
        
        &::placeholder {
          color: var(--text-tertiary);
        }
      }
    }
    
    .filters-wrapper {
      margin-top: $spacing-4;
      
      .filter-toggle {
        display: flex;
        align-items: center;
        gap: $spacing-2;
        padding: $spacing-2;
        background: none;
        border: none;
        color: var(--text-secondary);
        font-size: $font-size-sm;
        font-weight: $font-weight-medium;
        cursor: pointer;
        
        .chevron {
          transition: transform $transition-normal;
        }
      }
      
      .filters-content {
        margin-top: $spacing-4;
        padding: $spacing-4;
        background: var(--background-color);
        border-radius: $border-radius-lg;
        
        .filter-group {
          label {
            display: block;
            margin-bottom: $spacing-2;
            font-size: $font-size-sm;
            font-weight: $font-weight-medium;
            color: var(--text-primary);
          }
          
          .filter-chips {
            display: flex;
            flex-wrap: wrap;
            gap: $spacing-2;
            
            .filter-chip {
              display: flex;
              align-items: center;
              gap: $spacing-1;
              padding: $spacing-2 $spacing-3;
              background: var(--surface-color);
              border: $border-width solid var(--border-color);
              border-radius: $border-radius-xl;
              font-size: $font-size-sm;
              color: var(--text-secondary);
              cursor: pointer;
              transition: all $transition-fast;
              
              mat-icon {
                font-size: $font-size-base;
                width: $font-size-base;
                height: $font-size-base;
              }
              
              &:hover {
                border-color: $primary-color;
                color: $primary-color;
              }
              
              &.active {
                background: $primary-color;
                border-color: $primary-color;
                color: $white;
              }
            }
          }
        }
      }
    }
  }
  
  .feed-content {
    max-width: 1200px;
    margin: 0 auto;
    padding: $spacing-4;
    
    @include tablet {
      padding: $spacing-6;
    }
    
    .trending-section {
      margin-bottom: $spacing-6;
      
      .section-title {
        display: flex;
        align-items: center;
        gap: $spacing-2;
        margin-bottom: $spacing-3;
        font-size: $font-size-base;
        font-weight: $font-weight-semibold;
        color: var(--text-primary);
        
        mat-icon {
          color: $primary-color;
        }
      }
      
      .hashtags-list {
        display: flex;
        flex-wrap: wrap;
        gap: $spacing-2;
        
        .hashtag-chip {
          display: flex;
          align-items: center;
          gap: $spacing-1;
          padding: $spacing-2 $spacing-3;
          background: var(--surface-color);
          border: $border-width solid var(--border-color);
          border-radius: $border-radius-xl;
          font-size: $font-size-sm;
          color: var(--text-secondary);
          cursor: pointer;
          transition: all $transition-fast;
          
          .hash {
            color: $primary-color;
          }
          
          .count {
            font-size: $font-size-xs;
            color: var(--text-tertiary);
          }
          
          &:hover {
            background: rgba($primary-rgb, 0.05);
            border-color: $primary-color;
            transform: translateY(-2px);
          }
        }
      }
    }
    
    .feed-posts {
      .featured-post {
        margin-bottom: $spacing-6;
        
        .featured-badge {
          display: inline-flex;
          align-items: center;
          gap: $spacing-1;
          margin-bottom: $spacing-2;
          padding: $spacing-1 $spacing-2;
          background: linear-gradient(135deg, $primary-color 0%, $secondary-color 100%);
          border-radius: $border-radius-xl;
          font-size: $font-size-xs;
          font-weight: $font-weight-semibold;
          color: $white;
          
          mat-icon {
            font-size: $font-size-sm;
            width: $font-size-sm;
            height: $font-size-sm;
          }
        }
      }
      
      .posts-grid {
        display: grid;
        gap: $spacing-4;
        
        @include tablet {
          grid-template-columns: repeat(2, 1fr);
        }
        
        @include desktop {
          grid-template-columns: repeat(3, 1fr);
        }
      }
      
      .loading-container {
        display: flex;
        justify-content: center;
        padding: $spacing-8 0;
      }
      
      .empty-state {
        text-align: center;
        padding: $spacing-12 $spacing-4;
        
        .empty-icon {
          width: 80px;
          height: 80px;
          margin: 0 auto $spacing-4;
          background: rgba($primary-rgb, 0.1);
          border-radius: $border-radius-full;
          @include flex-center;
          
          mat-icon {
            font-size: $font-size-4xl;
            color: $primary-color;
          }
        }
        
        h3 {
          @include heading-small;
          margin: 0 0 $spacing-2;
          color: var(--text-primary);
        }
        
        p {
          @include body-medium;
          color: var(--text-secondary);
          margin: 0 0 $spacing-6;
        }
      }
      
      .end-feed {
        text-align: center;
        margin-top: $spacing-8;
        
        mat-divider {
          margin-bottom: $spacing-4;
        }
        
        p {
          @include body-small;
          color: var(--text-secondary);
        }
      }
    }
  }
  
  .fab-mobile {
    position: fixed;
    bottom: $spacing-6;
    right: $spacing-6;
    display: none;
    
    @include mobile {
      display: flex;
    }
  }
}

// Post Card Component
:host ::ng-deep app-feed-post-card {
  display: block;
  height: fit-content;
}

// Responsive Adjustments
@include mobile {
  .feed-header {
    .header-content {
      flex-direction: column;
      align-items: flex-start;
      gap: $spacing-3;
    }
  }
  
  .filters-wrapper {
    .filter-chips {
      overflow-x: auto;
      padding-bottom: $spacing-2;
      -webkit-overflow-scrolling: touch;
      
      &::-webkit-scrollbar {
        display: none;
      }
    }
  }
}

// Dark Mode Adjustments
[data-theme="dark"] {
  .feed-header {
    background: var(--surface-color);
    border-bottom-color: var(--border-color);
  }
  
  .search-input {
    background: var(--background-color);
    
    &:focus {
      box-shadow: 0 0 0 3px rgba($primary-rgb, 0.2);
    }
  }
  
  .hashtag-chip {
    &:hover {
      background: rgba($primary-rgb, 0.1);
    }
  }
}

// Animations
@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.feed-posts {
  animation: slideIn 0.5s ease-out;
}