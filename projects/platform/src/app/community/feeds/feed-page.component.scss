@import '../../../styles/variables';
@import '../../../styles/mixins';

// Variables specific to feed page
$sidebar-width: 280px;
$main-content-max-width: 680px;

// Main Container â€“ now always uses desktop layout
.feed-container {
  min-height: 100vh;
  background: $background-color;
  display: flex;
  padding-left: $sidebar-width;
}

.desktop-layout {
  display: flex;
  width: 100%;
  min-height: 100vh;
}


// Main Content
.main-content {
  flex: 1;
  max-width: $main-content-max-width;
  margin: 0 auto;
  padding: $spacing-4;

  .feed-header {
    @include flex-between;
    margin-bottom: $spacing-4;
    padding-bottom: $spacing-4;
    border-bottom: $border-width solid $border-color;

    .feed-tabs {
      display: flex;
      gap: $spacing-4;

      .tab-btn {
        background: none;
        border: none;
        padding: $spacing-2 $spacing-4;
        @include body-medium;
        font-weight: $font-weight-medium;
        color: $text-secondary;
        cursor: pointer;
        position: relative;

        &.active {
          color: $primary-color;
          font-weight: $font-weight-semibold;

          &::after {
            content: '';
            position: absolute;
            bottom: -$spacing-4;
            left: 0;
            right: 0;
            height: 3px;
            background: $primary-color;
            border-radius: 3px 3px 0 0;
          }
        }
      }
    }

    .filter-btn {
      background: none;
      border: $border-width solid $border-color;
      border-radius: $border-radius-lg;
      padding: $spacing-2;
      color: $text-secondary;
      cursor: pointer;

      &:hover {
        background: $background-color;
      }
    }
  }

  .create-post-box {
    display: flex;
    align-items: center;
    gap: $spacing-3;
    padding: $spacing-4;
    background: $surface-color;
    border: $border-width solid $border-color;
    border-radius: $border-radius-xl;
    margin-bottom: $spacing-6;

    .post-avatar {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      object-fit: cover;
    }

    .post-input {
      flex: 1;
      padding: $spacing-3;
      background: $background-color;
      border: none;
      border-radius: $border-radius-xl;
      color: $text-primary;
      @include body-small;
      cursor: pointer;

      &::placeholder {
        color: $text-tertiary;
      }

      &:hover {
        background: $surface-color;
      }
    }

    .post-media-btn {
      background: none;
      border: none;
      color: $primary-color;
      cursor: pointer;

      mat-icon {
        font-size: 24px;
      }
    }
  }

  .filters-panel {
    background: $surface-color;
    border: $border-width solid $border-color;
    border-radius: $border-radius-lg;
    padding: $spacing-4;
    margin-bottom: $spacing-4;

    .filter-section {
      h4 {
        margin: 0 0 $spacing-3 0;
        @include caption;
        color: $text-secondary;
      }

      .filter-chips {
        display: flex;
        flex-wrap: wrap;
        gap: $spacing-2;

        .chip {
          display: flex;
          align-items: center;
          gap: $spacing-1;
          padding: $spacing-2 $spacing-3;
          background: $background-color;
          border: $border-width solid $border-color;
          border-radius: $border-radius-xl;
          @include body-small;
          color: $text-secondary;
          cursor: pointer;
          transition: all $transition-fast;

          mat-icon {
            font-size: 18px;
            width: 18px;
            height: 18px;
          }

          &.active {
            background: $primary-color;
            border-color: $primary-color;
            color: $white;
          }

          &:hover:not(.active) {
            background: rgba($primary-rgb, 0.1);
            border-color: $primary-color;
          }
        }
      }
    }
  }

  .feed-posts {
    .featured-post-container {
      position: relative;
      margin-bottom: $spacing-6;

      .featured-badge {
        position: absolute;
        top: $spacing-2;
        left: $spacing-2;
        display: flex;
        align-items: center;
        gap: $spacing-1;
        padding: $spacing-1 $spacing-2;
        background: $gradient-primary;
        color: $white;
        border-radius: $border-radius-xl;
        @include caption;
        font-weight: $font-weight-semibold;
        z-index: 1;

        mat-icon {
          font-size: 16px;
          width: 16px;
          height: 16px;
        }
      }
    }

    .loading-spinner {
      @include flex-center;
      padding: $spacing-8;
    }

    .feed-end {
      text-align: center;
      padding: $spacing-8;

      .end-message {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: $spacing-2;
        color: $text-secondary;

        mat-icon {
          color: $success-color;
        }
      }
    }

    .empty-feed {
      text-align: center;
      padding: $spacing-12 $spacing-4;

      .empty-icon {
        width: 80px;
        height: 80px;
        margin: 0 auto $spacing-4;
        background: rgba($primary-rgb, 0.1);
        border-radius: 50%;
        @include flex-center;

        mat-icon {
          font-size: 40px;
          color: $primary-color;
        }
      }

      h3 {
        @include heading-small;
        margin: 0 0 $spacing-2 0;
        color: $text-primary;
      }

      p {
        @include body-medium;
        color: $text-secondary;
        margin: 0 0 $spacing-6 0;
      }
    }

    .scroll-anchor {
      height: 1px;
    }
  }
}

// Right Sidebar
.right-sidebar {
  width: $sidebar-width;
  padding: $spacing-4;

  .search-box {
    position: relative;
    margin-bottom: $spacing-4;

    .search-icon {
      position: absolute;
      left: $spacing-3;
      top: 50%;
      transform: translateY(-50%);
      color: $text-tertiary;
    }

    .clear-search {
      position: absolute;
      right: $spacing-3;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: $text-tertiary;
      cursor: pointer;
    }

    .search-input {
      @include form-input;
      padding-left: $spacing-8;
    }
  }

  .trending-box {
    background: $surface-color;
    border: $border-width solid $border-color;
    border-radius: $border-radius-lg;
    padding: $spacing-4;
    margin-bottom: $spacing-4;
    margin-top: $spacing-4;

    .trending-title {
      display: flex;
      align-items: center;
      gap: $spacing-2;
      margin: 0 0 $spacing-3 0;
      @include body-medium;
      font-weight: $font-weight-semibold;
      color: $text-primary;

      mat-icon {
        color: $primary-color;
      }
    }

    .trending-list {
      .trending-item {
        width: 100%;
        text-align: left;
        padding: $spacing-3;
        background: none;
        border: none;
        border-radius: $border-radius-lg;
        cursor: pointer;

        &:hover {
          background: $background-color;
        }

        .trending-tag {
          display: block;
          @include body-small;
          font-weight: $font-weight-semibold;
          color: $text-primary;
          margin-bottom: 2px;
        }

        .trending-count {
          @include caption;
        }
      }
    }
  }

  .sidebar-footer {
    display: flex;
    flex-wrap: wrap;
    gap: $spacing-2;
    padding: $spacing-4;

    a {
      color: $text-tertiary;
      @include caption;
      text-decoration: none;

      &:hover {
        text-decoration: underline;
      }
    }

    .copyright {
      width: 100%;
      color: $text-tertiary;
      @include caption;
      margin-top: $spacing-2;
    }
  }

  // Sticky behaviour
  position: sticky;
  top: $spacing-4;
  height: fit-content;
  max-height: calc(100vh - #{$spacing-4 * 2});
  overflow-y: auto;

  &::-webkit-scrollbar {
    display: none;
  }
}

// Posts grid
.feed-posts {
  .posts-grid {
    display: flex;
    flex-direction: column;
    gap: $spacing-4;
    width: 100%;
    max-width: 600px;
    margin: 0 auto;
  }
}

// Ensure post cards are visible
:host ::ng-deep app-feed-post-card {
  display: block;
  width: 100%;
}