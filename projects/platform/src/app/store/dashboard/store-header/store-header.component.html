<!-- components/store-header/store-header.component.html -->
<div class="store-header">
  <!-- No Store State -->
  @if (!store()) {
    <div class="no-store-header">
      <div class="header-content">
        <div class="welcome-section">
          <h1>Store Management</h1>
          <p>Manage your virtual store and track performance</p>
        </div>
        
        <div class="header-actions">
          <button mat-raised-button color="primary" (click)="onCreateStore()" class="create-store-btn">
            <mat-icon>add</mat-icon>
            Create Store
          </button>
          
          <button mat-button [matMenuTriggerFor]="helpMenu" class="help-menu-btn">
            <mat-icon>help</mat-icon>
          </button>
          
          <mat-menu #helpMenu="matMenu">
            <button mat-menu-item routerLink="/dashboard/stores/guide">
              <mat-icon>menu_book</mat-icon>
              <span>Getting Started Guide</span>
            </button>
            <button mat-menu-item routerLink="/dashboard/stores/tutorials">
              <mat-icon>ondemand_video</mat-icon>
              <span>Video Tutorials</span>
            </button>
            <button mat-menu-item routerLink="/dashboard/support">
              <mat-icon>support</mat-icon>
              <span>Contact Support</span>
            </button>
          </mat-menu>
        </div>
      </div>
    </div>
  } @else {
    <!-- Store Header with Data -->
    <div class="store-header-with-data">
      <div class="header-main">
        <div class="store-info">
          <div class="store-brand">
            <div class="store-logo">
              <img [src]="store()?.logo || '/assets/default-store.png'" 
                   [alt]="store()?.name"
                   class="logo-image">
              @if (store()?.isVerified) {
                <div class="verification-badge">
                  <mat-icon>verified</mat-icon>
                </div>
              }
            </div>
            
            <div class="store-details">
              <div class="store-title-section">
                <h1 class="store-name">{{ store()?.name }}</h1>
                <div class="store-status">
                  <mat-chip [color]="statusColor()" [disabled]="storeStatus() === 'inactive'">
                    <mat-icon class="status-icon">{{ statusIcon() }}</mat-icon>
                    <span class="status-text">
                      {{ storeStatus() | titlecase }}
                    </span>
                  </mat-chip>
                  
                  @if (store()?.verificationTier === 'premium') {
                    <mat-chip color="accent" class="premium-badge">
                      <mat-icon>stars</mat-icon>
                      <span>Premium</span>
                    </mat-chip>
                  }
                </div>
              </div>
              
              <p class="store-description">{{ store()?.description }}</p>
              
              <div class="store-meta">
                <span class="category-badge">{{ store()?.category }}</span>
                <span class="store-id">ID: {{ store()?._id?.slice(-8) }}</span>
                <span class="created-date">
                  Created {{ store()?.createdAt | date:'mediumDate' }}
                </span>
              </div>
            </div>
          </div>
        </div>
        
        <div class="header-actions">
          <!-- Primary Actions -->
          <div class="action-group primary-actions">
            <button mat-raised-button color="primary" (click)="onAddProduct()" class="desktop-action">
              <mat-icon>add</mat-icon>
              Add Product
            </button>
            
            @if (!store()?.isVerified) {
              <button mat-stroked-button color="primary" (click)="onVerifyStore()" class="verify-btn">
                <mat-icon>verified</mat-icon>
                Verify Store
              </button>
            }
            
            <button mat-button [matMenuTriggerFor]="storeMenu" class="store-menu-btn">
              <mat-icon>more_vert</mat-icon>
            </button>
          </div>
          
          <!-- Store Menu -->
          <mat-menu #storeMenu="matMenu">
            <button mat-menu-item (click)="onCreateStore()">
              <mat-icon>add_business</mat-icon>
              <span>Create New Store</span>
            </button>
            
            <button mat-menu-item [matMenuTriggerFor]="storesMenu">
              <mat-icon>storefront</mat-icon>
              <span>Switch Store</span>
              <mat-icon>arrow_right</mat-icon>
            </button>
            
            <mat-divider></mat-divider>
            
            <button mat-menu-item (click)="onExportData()">
              <mat-icon>download</mat-icon>
              <span>Export Store Data</span>
            </button>
            
            <button mat-menu-item (click)="onDuplicateStore()">
              <mat-icon>content_copy</mat-icon>
              <span>Duplicate Store</span>
            </button>
            
            <button mat-menu-item (click)="onArchiveStore()" class="archive-item">
              <mat-icon>archive</mat-icon>
              <span>Archive Store</span>
            </button>
          </mat-menu>

          <!-- Stores Submenu -->
          <mat-menu #storesMenu="matMenu" class="stores-submenu">
            @if (stores().length === 0) {
              <button mat-menu-item disabled>
                <mat-icon>storefront</mat-icon>
                <span>No other stores</span>
              </button>
            } @else {
              @for (storeItem of stores(); track trackByStoreId($index, storeItem)) {
                <button mat-menu-item 
                        (click)="onManageStore(storeItem._id!)"
                        [class.active]="storeItem._id === store()?._id">
                  <mat-icon>storefront</mat-icon>
                  <div class="store-menu-item">
                    <span class="store-name">{{ storeItem.name }}</span>
                    <span class="store-category">{{ storeItem.category }}</span>
                  </div>
                  @if (storeItem.isVerified) {
                    <mat-icon class="verified-badge" color="primary">verified</mat-icon>
                  }
                </button>
              }
            }
            
            <mat-divider></mat-divider>
            
            <button mat-menu-item (click)="onCreateStore()">
              <mat-icon>add</mat-icon>
              <span>Create New Store</span>
            </button>
          </mat-menu>
        </div>
      </div>
      
      <!-- Quick Stats Bar -->
      @if (storeStats()) {
        <div class="quick-stats-bar">
          <div class="stat-item">
            <div class="stat-value">{{ storeStats()!.views | number }}</div>
            <div class="stat-label">Total Views</div>
            <mat-icon class="stat-trend up">trending_up</mat-icon>
          </div>
          
          <div class="stat-item">
            <div class="stat-value">{{ storeStats()!.sales | number }}</div>
            <div class="stat-label">Sales</div>
            <mat-icon class="stat-trend up">trending_up</mat-icon>
          </div>
          
          <div class="stat-item">
            <div class="stat-value">{{ storeStats()!.conversion | number:'1.1-1' }}%</div>
            <div class="stat-label">Conversion</div>
            <mat-icon class="stat-trend up">trending_up</mat-icon>
          </div>
          
          <div class="stat-item">
            <div class="stat-value">â‚¦{{ storeStats()!.revenue | number }}</div>
            <div class="stat-label">Revenue</div>
            <mat-icon class="stat-trend up">trending_up</mat-icon>
          </div>
        </div>
      }
    </div>
  }
  
  <!-- Loading State -->
  @if (loading()) {
    <div class="loading-overlay">
      <mat-progress-spinner diameter="32" mode="indeterminate"></mat-progress-spinner>
      <span>Loading store data...</span>
    </div>
  }
</div>